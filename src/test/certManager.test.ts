/*********************************************************************
 * Copyright (c) Intel Corporation 2019
 * SPDX-License-Identifier: Apache-2.0
 **********************************************************************/

import { CertManager } from '../CertManager'
import { NodeForge } from '../NodeForge'
import { certificateObject } from '../models/Rcs'
test('issuer is from root', () => {

    let nodeForge = new NodeForge();
    let certManager = new CertManager(nodeForge);

    let certificateObject1: certificateObject = new certificateObject();
    certificateObject1.issuer = 'issuer';
    certificateObject1.pem = 'pem1';
    certificateObject1.subject = `subject1`;

    let certificateObject2: certificateObject = new certificateObject();
    certificateObject2.issuer = 'issuer2';
    certificateObject2.pem = 'pem2';
    certificateObject2.subject = `issuer`;

    let result = certManager.sortCertificate(certificateObject1, certificateObject2);
    expect(result).toEqual(true);
});


test('issuer is not from root', () => {

    let nodeForge = new NodeForge();
    let certManager = new CertManager(nodeForge);

    let certificateObject1: certificateObject = new certificateObject();
    certificateObject1.issuer = 'issuer';
    certificateObject1.pem = 'pem';
    certificateObject1.subject = `subject1`;

    let certificateObject2: certificateObject = new certificateObject();
    certificateObject2.issuer = 'issuer';
    certificateObject2.pem = 'pem';
    certificateObject2.subject = `issuer2`;

    let result = certManager.sortCertificate(certificateObject1, certificateObject2);
    expect(result).toEqual(false);
});


test('Extracts the provisioning certificate', () => {

    let pfxb64: string = "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";

    let nodeForge = new NodeForge();
    let certManager = new CertManager(nodeForge);

    // convert the certificate pfx to an object
    let pfxobj = certManager.convertPfxToObject(pfxb64, `Intel123!`);

    expect(pfxobj.errorText).toBeUndefined;
    expect(pfxobj.certs).toHaveLength(1);
    expect(pfxobj.keys).toHaveLength(1);

    let jsonPfxObj: string = JSON.stringify(pfxobj)
    let jsonPfxObj64 = Buffer.from(jsonPfxObj).toString("base64");


    let actual: string = "eyJjZXJ0cyI6W3sidmVyc2lvbiI6Miwic2VyaWFsTnVtYmVyIjoiMzAzMjFiNGZhOWE5NDBhZjQ3YTRmZWM4YzM3YjdjYzIiLCJzaWduYXR1cmVPaWQiOiIxLjIuODQwLjExMzU0OS4xLjEuMTEiLCJzaWduYXR1cmUiOiLCjFvDmnXCkmlhwrrDj8ORYsKjwp7Cg19VwrLCsE9cdTAwMDTDscOlw4NbaERcdTAwMWPCp8KVQ29lKcO6ZVx1MDAwMMOoWVx1MDAwNMKNwoLDpcOrwqVcdTAwMWJcdTAwMDfClFxmf3Q0wrLCtm/CjzRoQMO+w7xpUytjwoXDjMK+asOZeMKBb3JcdTAwMTLCpS/CokbDsMOkVkVcZlx1MDAxNjNcImxhZmpcdTAwMGZcdTAwMGbCqHnDvlx1MDAxM8KmVMOjwrpcdTAwMDRcdTAwMTHDmsKpw45af0RcdTAwMDPDq8OeLcOjw6zDt8OqK2bDvMO4wr3CgMOuUMOzwphfw5Q9w5nChT3DnMKCXHUwMDBlw7VccsOswoIkXHUwMDBmfUhcdTAwMTA7woJHR8Oyw5pcdTAwMGXCmlx1MDAxY0ttw55cdTAwMDfCqcOtc1xubSMsXCIvaDHCk27DgCvDlMORwpbCoMOfw5FYXlxuXHLCusKvXHUwMDExKMOVXHUwMDAywrRzw5rCvlPDgi/Cu39cbsKMwrHCslx1MDAwZcKPdMOaw4ZcdTAwMDDDl1x1MDAwM8KlXHUwMDBmXHUwMDE0wqnCt8O9wobCpMK0w7PDsltcdTAwMWRcdTAwMTbCgG7DksOIwrlQJVx1MDAwNko9b01cdTAwMWNcdTAwMTN3M8OXfmE8TntccsOLw4p1w71cdTAwMWMoXGIsw4fCiCIsInNpZ2luZm8iOnsiYWxnb3JpdGhtT2lkIjoiMS4yLjg0MC4xMTM1NDkuMS4xLjExIiwicGFyYW1ldGVycyI6e319LCJ2YWxpZGl0eSI6eyJub3RCZWZvcmUiOiIyMDE5LTA4LTEzVDE2OjE3OjMyLjAwMFoiLCJub3RBZnRlciI6IjIwMjAtMDgtMTNUMDA6MDA6MDAuMDAwWiJ9LCJpc3N1ZXIiOnsiYXR0cmlidXRlcyI6W3sidHlwZSI6IjIuNS40LjMiLCJ2YWx1ZSI6ImJqb3NidXJuLWRlc2sxLmFtci5jb3JwLmludGVsLmNvbSIsInZhbHVlVGFnQ2xhc3MiOjE5LCJuYW1lIjoiY29tbW9uTmFtZSIsInNob3J0TmFtZSI6IkNOIn1dLCJoYXNoIjoiY2Q0YjgxM2QzNDY0ZjA4YWFhYzI0NmZiMTA5ZmI2Y2E5YmY5MmQzZCJ9LCJzdWJqZWN0Ijp7ImF0dHJpYnV0ZXMiOlt7InR5cGUiOiIyLjUuNC4zIiwidmFsdWUiOiJiam9zYnVybi1kZXNrMS5hbXIuY29ycC5pbnRlbC5jb20iLCJ2YWx1ZVRhZ0NsYXNzIjoxOSwibmFtZSI6ImNvbW1vbk5hbWUiLCJzaG9ydE5hbWUiOiJDTiJ9XSwiaGFzaCI6ImNkNGI4MTNkMzQ2NGYwOGFhYWMyNDZmYjEwOWZiNmNhOWJmOTJkM2QifSwiZXh0ZW5zaW9ucyI6W3siaWQiOiIyLjUuMjkuMTUiLCJjcml0aWNhbCI6ZmFsc2UsInZhbHVlIjoiXHUwMDAzXHUwMDAyXHUwMDA0MCIsIm5hbWUiOiJrZXlVc2FnZSIsImRpZ2l0YWxTaWduYXR1cmUiOmZhbHNlLCJub25SZXB1ZGlhdGlvbiI6ZmFsc2UsImtleUVuY2lwaGVybWVudCI6dHJ1ZSwiZGF0YUVuY2lwaGVybWVudCI6dHJ1ZSwia2V5QWdyZWVtZW50IjpmYWxzZSwia2V5Q2VydFNpZ24iOmZhbHNlLCJjUkxTaWduIjpmYWxzZSwiZW5jaXBoZXJPbmx5IjpmYWxzZSwiZGVjaXBoZXJPbmx5IjpmYWxzZX0seyJpZCI6IjIuNS4yOS4zNyIsImNyaXRpY2FsIjpmYWxzZSwidmFsdWUiOiIwXG5cdTAwMDZcYitcdTAwMDZcdTAwMDFcdTAwMDVcdTAwMDVcdTAwMDdcdTAwMDNcdTAwMDEiLCJuYW1lIjoiZXh0S2V5VXNhZ2UiLCJzZXJ2ZXJBdXRoIjp0cnVlfSx7ImlkIjoiMi41LjI5LjE3IiwiY3JpdGljYWwiOmZhbHNlLCJ2YWx1ZSI6IjAjwoIhYmpvc2J1cm4tZGVzazEuYW1yLmNvcnAuaW50ZWwuY29tIiwibmFtZSI6InN1YmplY3RBbHROYW1lIiwiYWx0TmFtZXMiOlt7InR5cGUiOjIsInZhbHVlIjoiYmpvc2J1cm4tZGVzazEuYW1yLmNvcnAuaW50ZWwuY29tIn1dfV0sInB1YmxpY0tleSI6eyJuIjp7ImRhdGEiOlsyMjczODU0NSwxOTc1ODc5NzUsNDAzODk2MzIsMTI4NTc0NzE4LDI0MDUwNjYwOSw2MzgwODAwNCw2NzE4NzA1MiwzNTkxOTU3MiwxNjk3MzczNjYsMzM5MzY1NjUsMTg1NjM1NjIwLDE0NzQ5Mjk5MCwyMTI4NjY1NTUsODQzOTU3MDcsMTg1NDE2NDQ2LDkzNTg3NjcsMjAyNDQ1MDU0LDIzNjcwMzQ1MCw0ODk2NjM2OCwxMzgxNjEzMTgsMTE4MTQ4NDU2LDI0MzA2Njk3NiwxNzA4MTA4ODksNTkwNjE1MDgsMzg3MjExMTEsNTgyMjE5OSwxMzg3MDkwMzYsMTAyMTAyOTMxLDExNjIyNjYzOSwyNjU3MTMzMTYsNzE2MDc4NywxMzQzMDg0NjksMjI2NDI3OTcwLDE5ODQ2ODI3MSwyODczODUzOCwxMTgwOTU3NDYsMjAxMzM4NzUxLDgxOTcwNDU1LDY3Nzc4MDI4LDQ2ODMzMjM5LDIwMjAwMzE4LDE5MDY5MDYzNywxOTMwOTkxNDgsMTg3ODI3OSwyNTIxNDQ2MzcsMjUzMTE4ODU1LDc2OTg0NzE0LDgyNDQ3MjY0LDI0MDEyMjcwMSwyMTM3OTYyNzcsOTQxODQ1NDgsMTI3NjE3MzMyLDcwOTg1MzE1LDMwMzcwNzM1LDI2NjU1MDYyMCw4NTQyMTU0NywxNTkxODgzNjgsMjAyNDAwMzMyLDIxODkyNTgxMywxMjkyMTUxNTYsMjMyMzQ2OTQwLDExNzYxODI0OCwyNjg0MTYyOTgsNzgwNTkzOSwyMjc5ODM5ODksNTYwOTMxMTEsMjM2MjEyODgyLDIzMDYyNjAzMSwxMjA1OTM3NzEsODUzODE5MDksOTMxMjEyODIsMjYwMzEyODgxLDg2NTIxNzYwLDEyXSwidCI6NzQsInMiOjB9LCJlIjp7ImRhdGEiOls2NTUzN10sInQiOjEsInMiOjB9fSwibWQiOnsiYWxnb3JpdGhtIjoic2hhMjU2IiwiYmxvY2tMZW5ndGgiOjY0LCJkaWdlc3RMZW5ndGgiOjMyLCJtZXNzYWdlTGVuZ3RoIjo1NDQsImZ1bGxNZXNzYWdlTGVuZ3RoIjpbMCw1NDRdLCJtZXNzYWdlTGVuZ3RoU2l6ZSI6OCwibWVzc2FnZUxlbmd0aDY0IjpbMCw1NDRdfSwic2lnbmF0dXJlUGFyYW1ldGVycyI6e30sInRic0NlcnRpZmljYXRlIjp7InRhZ0NsYXNzIjowLCJ0eXBlIjoxNiwiY29uc3RydWN0ZWQiOnRydWUsImNvbXBvc2VkIjp0cnVlLCJ2YWx1ZSI6W3sidGFnQ2xhc3MiOjEyOCwidHlwZSI6MCwiY29uc3RydWN0ZWQiOnRydWUsImNvbXBvc2VkIjp0cnVlLCJ2YWx1ZSI6W3sidGFnQ2xhc3MiOjAsInR5cGUiOjIsImNvbnN0cnVjdGVkIjpmYWxzZSwiY29tcG9zZWQiOmZhbHNlLCJ2YWx1ZSI6Ilx1MDAwMiJ9XX0seyJ0YWdDbGFzcyI6MCwidHlwZSI6MiwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiMDJcdTAwMWJPwqnCqUDCr0fCpMO+w4jDg3t8w4IifSx7InRhZ0NsYXNzIjowLCJ0eXBlIjoxNiwiY29uc3RydWN0ZWQiOnRydWUsImNvbXBvc2VkIjp0cnVlLCJ2YWx1ZSI6W3sidGFnQ2xhc3MiOjAsInR5cGUiOjYsImNvbnN0cnVjdGVkIjpmYWxzZSwiY29tcG9zZWQiOmZhbHNlLCJ2YWx1ZSI6IirChkjChsO3XHJcdTAwMDFcdTAwMDFcdTAwMGIifSx7InRhZ0NsYXNzIjowLCJ0eXBlIjo1LCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjpmYWxzZSwidmFsdWUiOiIifV19LHsidGFnQ2xhc3MiOjAsInR5cGUiOjE2LCJjb25zdHJ1Y3RlZCI6dHJ1ZSwiY29tcG9zZWQiOnRydWUsInZhbHVlIjpbeyJ0YWdDbGFzcyI6MCwidHlwZSI6MTcsImNvbnN0cnVjdGVkIjp0cnVlLCJjb21wb3NlZCI6dHJ1ZSwidmFsdWUiOlt7InRhZ0NsYXNzIjowLCJ0eXBlIjoxNiwiY29uc3RydWN0ZWQiOnRydWUsImNvbXBvc2VkIjp0cnVlLCJ2YWx1ZSI6W3sidGFnQ2xhc3MiOjAsInR5cGUiOjYsImNvbnN0cnVjdGVkIjpmYWxzZSwiY29tcG9zZWQiOmZhbHNlLCJ2YWx1ZSI6IlVcdTAwMDRcdTAwMDMifSx7InRhZ0NsYXNzIjowLCJ0eXBlIjoxOSwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiYmpvc2J1cm4tZGVzazEuYW1yLmNvcnAuaW50ZWwuY29tIn1dfV19XX0seyJ0YWdDbGFzcyI6MCwidHlwZSI6MTYsImNvbnN0cnVjdGVkIjp0cnVlLCJjb21wb3NlZCI6dHJ1ZSwidmFsdWUiOlt7InRhZ0NsYXNzIjowLCJ0eXBlIjoyMywiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiMTkwODEzMTYxNzMyWiJ9LHsidGFnQ2xhc3MiOjAsInR5cGUiOjIzLCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjpmYWxzZSwidmFsdWUiOiIyMDA4MTMwMDAwMDBaIn1dfSx7InRhZ0NsYXNzIjowLCJ0eXBlIjoxNiwiY29uc3RydWN0ZWQiOnRydWUsImNvbXBvc2VkIjp0cnVlLCJ2YWx1ZSI6W3sidGFnQ2xhc3MiOjAsInR5cGUiOjE3LCJjb25zdHJ1Y3RlZCI6dHJ1ZSwiY29tcG9zZWQiOnRydWUsInZhbHVlIjpbeyJ0YWdDbGFzcyI6MCwidHlwZSI6MTYsImNvbnN0cnVjdGVkIjp0cnVlLCJjb21wb3NlZCI6dHJ1ZSwidmFsdWUiOlt7InRhZ0NsYXNzIjowLCJ0eXBlIjo2LCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjpmYWxzZSwidmFsdWUiOiJVXHUwMDA0XHUwMDAzIn0seyJ0YWdDbGFzcyI6MCwidHlwZSI6MTksImNvbnN0cnVjdGVkIjpmYWxzZSwiY29tcG9zZWQiOmZhbHNlLCJ2YWx1ZSI6ImJqb3NidXJuLWRlc2sxLmFtci5jb3JwLmludGVsLmNvbSJ9XX1dfV19LHsidGFnQ2xhc3MiOjAsInR5cGUiOjE2LCJjb25zdHJ1Y3RlZCI6dHJ1ZSwiY29tcG9zZWQiOnRydWUsInZhbHVlIjpbeyJ0YWdDbGFzcyI6MCwidHlwZSI6MTYsImNvbnN0cnVjdGVkIjp0cnVlLCJjb21wb3NlZCI6dHJ1ZSwidmFsdWUiOlt7InRhZ0NsYXNzIjowLCJ0eXBlIjo2LCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjpmYWxzZSwidmFsdWUiOiIqwoZIwobDt1xyXHUwMDAxXHUwMDAxXHUwMDAxIn0seyJ0YWdDbGFzcyI6MCwidHlwZSI6NSwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiIn1dfSx7InRhZ0NsYXNzIjowLCJ0eXBlIjozLCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjp0cnVlLCJ2YWx1ZSI6W3sidGFnQ2xhc3MiOjAsInR5cGUiOjE2LCJjb25zdHJ1Y3RlZCI6dHJ1ZSwiY29tcG9zZWQiOnRydWUsInZhbHVlIjpbeyJ0YWdDbGFzcyI6MCwidHlwZSI6MiwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiXHUwMDAww4UoN8Kgw7hAw7NcdTAwMTXCjMOrXHUwMDAyUW0xVzBcdTAwMWRrw5vDsS7Dvlx1MDAxNFLCkjV+wpt9wpbDgnVcdTAwMDdxwr8/w7/CtSpwK2TCjcOZVTx7OsKrTVxmworDtcOBXHUwMDA2JMOJfVx1MDAwNcKQUXbDnsK/w6M9XFxcdTAwMWPDtsK6w7Q7JmN5wrTCk0XCnSRkw4vDpFteT8O7TU7CoMK6XHUwMDA0wpbCscKKw7Fkwph/XHUwMDA3a8O9XHUwMDAxw4rCkHvCgnXCjMK1w5tUw5E0O34swqnDpXRcbjXDrE4sUXxcdTAwMDAvf3DCn8O4IcK2woPDqsK9RirDvX9cdTAwMDRCwoBcdTAwMTYnUG1Dw5PDvWdqRsOtek9hX3k4RMKILFx1MDAwNcKNb3JOw5ZXOFNQSi5eXHTDp8OOwoZcdTAwMDdcbsONaMKDw4LDimLDqyrDoMOhwrzDrcKsXHUwMDExXHUwMDEww75cYsOsw5rDu1xyOsO+UHxrwrzCsFx1MDAxNcO7wozCqVx1MDAwN8OrXHUwMDEwwpMkIF1LWlx1MDAxZMO8wpZcIkFtRFx1MDAwMTFsPMOaIE5Vw5bDsXrCnk/DomhMXHUwMDAwwrxvQHFaw7ZxIn0seyJ0YWdDbGFzcyI6MCwidHlwZSI6MiwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiXHUwMDAxXHUwMDAwXHUwMDAxIn1dfV0sImJpdFN0cmluZ0NvbnRlbnRzIjoiXHUwMDAwMMKCXHUwMDAxXG5cdTAwMDLCglx1MDAwMVx1MDAwMVx1MDAwMMOFKDfCoMO4QMOzXHUwMDE1wozDq1x1MDAwMlFtMVcwXHUwMDFka8Obw7Euw75cdTAwMTRSwpI1fsKbfcKWw4J1XHUwMDA3ccK/P8O/wrUqcCtkwo3DmVU8ezrCq01cZsKKw7XDgVx1MDAwNiTDiX1cdTAwMDXCkFF2w57Cv8OjPVxcXHUwMDFjw7bCusO0OyZjecK0wpNFwp0kZMOLw6RbXk/Du01OwqDCulx1MDAwNMKWwrHCisOxZMKYf1x1MDAwN2vDvVx1MDAwMcOKwpB7woJ1wozCtcObVMORNDt+LMKpw6V0XG41w6xOLFF8XHUwMDAwL39wwp/DuCHCtsKDw6rCvUYqw71/XHUwMDA0QsKAXHUwMDE2J1BtQ8OTw71nakbDrXpPYV95OETCiCxcdTAwMDXCjW9yTsOWVzhTUEouXlx0w6fDjsKGXHUwMDA3XG7DjWjCg8OCw4piw6sqw6DDocK8w63CrFx1MDAxMVx1MDAxMMO+XGLDrMOaw7tccjrDvlB8a8K8wrBcdTAwMTXDu8KMwqlcdTAwMDfDq1x1MDAxMMKTJCBdS1pcdTAwMWTDvMKWXCJBbURcdTAwMDExbDzDmiBOVcOWw7F6wp5Pw6JoTFx1MDAwMMK8b0BxWsO2cVx1MDAwMlx1MDAwM1x1MDAwMVx1MDAwMFx1MDAwMSIsIm9yaWdpbmFsIjp7InRhZ0NsYXNzIjowLCJ0eXBlIjozLCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjp0cnVlLCJ2YWx1ZSI6W3sidGFnQ2xhc3MiOjAsInR5cGUiOjE2LCJjb25zdHJ1Y3RlZCI6dHJ1ZSwiY29tcG9zZWQiOnRydWUsInZhbHVlIjpbeyJ0YWdDbGFzcyI6MCwidHlwZSI6MiwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiXHUwMDAww4UoN8Kgw7hAw7NcdTAwMTXCjMOrXHUwMDAyUW0xVzBcdTAwMWRrw5vDsS7Dvlx1MDAxNFLCkjV+wpt9wpbDgnVcdTAwMDdxwr8/w7/CtSpwK2TCjcOZVTx7OsKrTVxmworDtcOBXHUwMDA2JMOJfVx1MDAwNcKQUXbDnsK/w6M9XFxcdTAwMWPDtsK6w7Q7JmN5wrTCk0XCnSRkw4vDpFteT8O7TU7CoMK6XHUwMDA0wpbCscKKw7Fkwph/XHUwMDA3a8O9XHUwMDAxw4rCkHvCgnXCjMK1w5tUw5E0O34swqnDpXRcbjXDrE4sUXxcdTAwMDAvf3DCn8O4IcK2woPDqsK9RirDvX9cdTAwMDRCwoBcdTAwMTYnUG1Dw5PDvWdqRsOtek9hX3k4RMKILFx1MDAwNcKNb3JOw5ZXOFNQSi5eXHTDp8OOwoZcdTAwMDdcbsONaMKDw4LDimLDqyrDoMOhwrzDrcKsXHUwMDExXHUwMDEww75cYsOsw5rDu1xyOsO+UHxrwrzCsFx1MDAxNcO7wozCqVx1MDAwN8OrXHUwMDEwwpMkIF1LWlx1MDAxZMO8wpZcIkFtRFx1MDAwMTFsPMOaIE5Vw5bDsXrCnk/DomhMXHUwMDAwwrxvQHFaw7ZxIn0seyJ0YWdDbGFzcyI6MCwidHlwZSI6MiwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiXHUwMDAxXHUwMDAwXHUwMDAxIn1dfV19fV19LHsidGFnQ2xhc3MiOjEyOCwidHlwZSI6MywiY29uc3RydWN0ZWQiOnRydWUsImNvbXBvc2VkIjp0cnVlLCJ2YWx1ZSI6W3sidGFnQ2xhc3MiOjAsInR5cGUiOjE2LCJjb25zdHJ1Y3RlZCI6dHJ1ZSwiY29tcG9zZWQiOnRydWUsInZhbHVlIjpbeyJ0YWdDbGFzcyI6MCwidHlwZSI6MTYsImNvbnN0cnVjdGVkIjp0cnVlLCJjb21wb3NlZCI6dHJ1ZSwidmFsdWUiOlt7InRhZ0NsYXNzIjowLCJ0eXBlIjo2LCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjpmYWxzZSwidmFsdWUiOiJVXHUwMDFkXHUwMDBmIn0seyJ0YWdDbGFzcyI6MCwidHlwZSI6NCwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiXHUwMDAzXHUwMDAyXHUwMDA0MCJ9XX0seyJ0YWdDbGFzcyI6MCwidHlwZSI6MTYsImNvbnN0cnVjdGVkIjp0cnVlLCJjb21wb3NlZCI6dHJ1ZSwidmFsdWUiOlt7InRhZ0NsYXNzIjowLCJ0eXBlIjo2LCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjpmYWxzZSwidmFsdWUiOiJVXHUwMDFkJSJ9LHsidGFnQ2xhc3MiOjAsInR5cGUiOjQsImNvbnN0cnVjdGVkIjpmYWxzZSwiY29tcG9zZWQiOmZhbHNlLCJ2YWx1ZSI6IjBcblx1MDAwNlxiK1x1MDAwNlx1MDAwMVx1MDAwNVx1MDAwNVx1MDAwN1x1MDAwM1x1MDAwMSJ9XX0seyJ0YWdDbGFzcyI6MCwidHlwZSI6MTYsImNvbnN0cnVjdGVkIjp0cnVlLCJjb21wb3NlZCI6dHJ1ZSwidmFsdWUiOlt7InRhZ0NsYXNzIjowLCJ0eXBlIjo2LCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjpmYWxzZSwidmFsdWUiOiJVXHUwMDFkXHUwMDExIn0seyJ0YWdDbGFzcyI6MCwidHlwZSI6NCwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiMCPCgiFiam9zYnVybi1kZXNrMS5hbXIuY29ycC5pbnRlbC5jb20ifV19XX1dfV19fV0sImtleXMiOlt7Im4iOnsiZGF0YSI6WzIyNzM4NTQ1LDE5NzU4Nzk3NSw0MDM4OTYzMiwxMjg1NzQ3MTgsMjQwNTA2NjA5LDYzODA4MDA0LDY3MTg3MDUyLDM1OTE5NTcyLDE2OTczNzM2NiwzMzkzNjU2NSwxODU2MzU2MjAsMTQ3NDkyOTkwLDIxMjg2NjU1NSw4NDM5NTcwNywxODU0MTY0NDYsOTM1ODc2NywyMDI0NDUwNTQsMjM2NzAzNDUwLDQ4OTY2MzY4LDEzODE2MTMxOCwxMTgxNDg0NTYsMjQzMDY2OTc2LDE3MDgxMDg4OSw1OTA2MTUwOCwzODcyMTExMSw1ODIyMTk5LDEzODcwOTAzNiwxMDIxMDI5MzEsMTE2MjI2NjM5LDI2NTcxMzMxNiw3MTYwNzg3LDEzNDMwODQ2OSwyMjY0Mjc5NzAsMTk4NDY4MjcxLDI4NzM4NTM4LDExODA5NTc0NiwyMDEzMzg3NTEsODE5NzA0NTUsNjc3NzgwMjgsNDY4MzMyMzksMjAyMDAzMTgsMTkwNjkwNjM3LDE5MzA5OTE0OCwxODc4Mjc5LDI1MjE0NDYzNywyNTMxMTg4NTUsNzY5ODQ3MTQsODI0NDcyNjQsMjQwMTIyNzAxLDIxMzc5NjI3Nyw5NDE4NDU0OCwxMjc2MTczMzIsNzA5ODUzMTUsMzAzNzA3MzUsMjY2NTUwNjIwLDg1NDIxNTQ3LDE1OTE4ODM2OCwyMDI0MDAzMzIsMjE4OTI1ODEzLDEyOTIxNTE1NiwyMzIzNDY5NDAsMTE3NjE4MjQ4LDI2ODQxNjI5OCw3ODA1OTM5LDIyNzk4Mzk4OSw1NjA5MzExMSwyMzYyMTI4ODIsMjMwNjI2MDMxLDEyMDU5Mzc3MSw4NTM4MTkwOSw5MzEyMTI4MiwyNjAzMTI4ODEsODY1MjE3NjAsMTJdLCJ0Ijo3NCwicyI6MH0sImUiOnsiZGF0YSI6WzY1NTM3XSwidCI6MSwicyI6MH0sImQiOnsiZGF0YSI6WzEwMzc1ODYyOSwzNTE4MDMxLDIwNzcwNzY3NCwyMDc4Nzg2MjUsMzIzMzAxODAsMTkwNTg0NDQsNTg4ODI3NjYsMTg3NjQ1NDEsODIzMzkzNzYsMTA3MjM0NzY1LDU4OTA3MzE2LDIxNTIwMjE4LDg3NTY1OTM1LDI1NTQ3OTU2NCw0NTg4MDIyNywyMTg3MTAyNiwyNDM4NDk3MzcsMjIxMzA5MzcxLDEyMjczNzYyNSw5NzM2NjAzMiwxNzQwMDA0MDYsMTk3ODg0NTY2LDU1Mjg0NTY0LDM4Njk1NjU4LDEyNjEyODAzMSw4OTY1OTI3NSwxMTQyNzExMDYsMTg5NDgwMTQ2LDM2Njk1NDYxLDExNzQwMjEyMSw4MjE0NzExMywxNDM1MDc5MTUsMTUwMjY4MjkyLDExMTM3MTkzMCwxMTkzOTIwNDcsNDM0NDY3MjgsMjYxNDAzMDg0LDIwMTUxOTEwNSwxNTkwNjM5NDEsOTE0MjQwOTQsMTIxMTUyMjAxLDIxNDMwNTkwMSwyMDU5MjY4OTYsNTg1Nzg0MzksOTA3MjcxNTIsMjEyNjQ5ODgsMTAxNjc2NTY3LDE4MzgzMDEyOCwxODIzNzc3MTMsMTM3NzIzMzA3LDIxNzEwODI2Myw5MzM5ODU3MSwxODIyNTA0NiwyNjQxMjk2MjYsMjYzODg5OTI4LDIxODg5NTI0OCwxNTUzOTM5MDQsMjE0NTc2MDQ4LDE0ODgzNDQwNiwxOTc1NTk2NTEsNjA3Mjc2NTAsMTk2NzM2MjE3LDI1ODIxODE1NywyNTM0NTIzMzcsMjY0Nzk1OTQ0LDE5OTMyOTgxNyw0OTIzODYyOCwyMzMyNzkxNjEsNjE2ODg5OTIsMzU5Mjk2MTYsMjA2ODU4MTQzLDE1MzkwNDI0Myw4MjA4ODc0NCwxXSwidCI6NzQsInMiOjB9LCJwIjp7ImRhdGEiOlsyMjU4Njc2ODcsMTM3Mjc3OTcwLDE4Njc1NDE4MywxNzE0MzgwOTgsMTQ3NzkxNDc3LDI2NDI0ODAxLDIyNTA1OTM1NCwyNTE0MTgzMDksMTQwMTMyNDk0LDI3MjI0MzUyLDgyMzc5MDQ2LDI2MjgzMDE4MSwyMjgyODMzNTAsMjE4MDAxNzkxLDE5ODQyNTk1NCwyMTQyMTIxNDgsMjA0NDExNjg4LDExODEyMzkzLDc1OTc3OTcyLDU1MTU2NDksMTM5Mjk0OTg3LDI2OTIyMjUsNDIxMzYyOTksNzYzMTYwNjksMjUxMTc1MjgzLDIzNTQzNDIwOCwxNjg5ODYwOTUsNTA3NDk5MTUsNTk1MDk0NzMsMTU5MTk2NzQ3LDE0NTQxODI2LDc4NjgxNjkwLDMzOTAyNTE2LDE5MzczOTAxMiwxODUzMjU2MDksMTYxNDgwMjgsNTUyMTVdLCJ0IjozNywicyI6MH0sInEiOnsiZGF0YSI6WzEzNTQ1NTc4MywxNDE2NzUyMjYsNzI0NTU1NjMsMTkyMzE2NTM1LDIyNzU2MTY4Myw5MjQ0Mzg1LDE1MDQxNzAzOSwxNzkwNDcwMTAsMjQwNzcwNDgzLDIzNzI3ODI4MiwyNTUyMDAzNzYsOTg5MjUwMiwyMzI3MzcwNjQsMTgxMTM4MTY5LDQzMjEzMTg4LDEyMDE0MTQ2NSw2MTcxMDUyMSwxMDM2MjQyMTYsMTMxNzgwOTAxLDE2NzY4ODUwNywxNDY1NTQ0NjUsMjYwMzYxMzMsOTU5MjA2NjcsOTkwMzU1MzEsNTE1MTkxMDEsOTIwOTI4ODUsMjQzMjM1NDc4LDE0OTk3MjMyNywxNTU1MzU5NywxMzYzOTE3NzAsMjAxNzcyMzY0LDE5NTE3Mjc1NywxOTQyMjAxNDcsMTU0NzA0MTgyLDE4NTkwODk3OSwxNjQ1MTQxMTYsNTk5MDZdLCJ0IjozNywicyI6MH0sImRQIjp7ImRhdGEiOlsyMTI2NTAyNDksNTkzMjcxOSwzMTMwNjcxMSwxOTQ1MjkxMjMsNDkwMDExMiwyNTUwOTE4MCwxODMwMDM0NzMsMzA5MzAzMTgsMTA4Njg4MjYyLDU0NjU5Njc4LDIwODQ5NTg3MCw1MjgxMDQ3MSwxOTIwODQ3MjAsMjMwMDg2MTUyLDE5Mzc4OTg4NCw3OTI2OTMyOCwyNjE1MTIyMjcsMTI1NTU2NzgzLDE1NTA4NDYyMywxOTQ5Mjg3MjcsMjI3NzI0NTY4LDE4NjA0ODQ2OSwxNTIwMzkwNjYsMzkwMTMwOTksMjMzNzU2MjM4LDE4NTY5MjU1OSwyMzgxNjM3MzIsNDA2MTM5NDIsMjM1MDk1Mjg0LDIwNjA0MzU3OSw5NjE5NTUxNSwxNTI0MjMxMDUsOTUwOTE5NSwxOTg2MjMyNzQsMTgxMjc0Mjc1LDE5OTkwMzgzMiwyOTk2Ml0sInQiOjM3LCJzIjowfSwiZFEiOnsiZGF0YSI6WzIxNDg4NDg0NywyMDQ0ODU5MzIsMjU0NzMzMzQ0LDIwNzg2MTE2MSw4NDAxNjExNSwyMDUzMzc4NjYsMTkxNDEyMDk3LDIyMjA3NDI2MCwxNDQ2OTI2NTEsMjI0OTU3MzM5LDc1MDIxNjYyLDIyNzE2MjExNyw3NDUyNjMyNywxNTIwNTIwOSwxNjIwNjYwNzAsMzMxODUxNjIsMjQxNzI4NjgyLDE1OTI5MzczNiwxNjc1OTY0ODEsMzU1NTExNSwyNTU1MTk0NDEsNjU3MzEyODAsMTEyNTM4MzM4LDYwMzQ0MTgzLDI0NDk5MzQyMiwyMDg4NTY0OCwxNTE0NzQ3OTEsMjU3ODQ0NjQxLDE3MzkxOTMxOSwyMjE1MzE4NTksMTIyNzYxODg5LDE0MDkwMzE3NiwxMTE4NTEyNTIsMjQzNTE4MDk0LDEzODU4ODQ4OCwyNDA2MzEyMjAsNDc5XSwidCI6MzcsInMiOjB9LCJxSW52Ijp7ImRhdGEiOlsxMTQ2MjYxNzAsMjI1Njg5OTcwLDYzNTE2MDI0LDE0ODI3NjUxNywyMTg2ODM0NzQsMTkyNDQ3Mjk2LDEzMDU3MjIxOSwyMjMxNDU5MjEsMjM3MDg3NTI2LDE5NzAxNDQyNCwyMzI4OTUwMjEsMTkzMDMxOTg1LDYyNTI4MzE4LDEyNTk3MDM2LDg1NzA4MzU5LDk1ODA0NjgxLDU5MjA4MDAwLDE5MTA1MzQ1LDExMjkxOTU2NSwxMzA2NDIwMjYsMTg0Mjg3MDg0LDIwODk2Njg0Niw5OTIwMDMzNywxMzgzNDEwMzYsMTYwNjk1MTg4LDUxOTg1OTU3LDYyNzQ5MTY0LDIxMDYyMDMwMywxNjE2MDUwMDcsODQ5MzI1MjAsMjE5ODgyMzgzLDIwMTM0ODA4NywxOTYyMTM4MzgsMzk5Njk1MTMsMjY0MDAzNTE0LDY4OTU3NjI4LDE0MjE4XSwidCI6MzcsInMiOjB9fV19"

    expect(actual).toEqual(jsonPfxObj64);
});



test('Pulls the provisioning certificate apart and exports each PEM', () => {

    let input: string = "eyJjZXJ0cyI6W3sidmVyc2lvbiI6Miwic2VyaWFsTnVtYmVyIjoiMzAzMjFiNGZhOWE5NDBhZjQ3YTRmZWM4YzM3YjdjYzIiLCJzaWduYXR1cmVPaWQiOiIxLjIuODQwLjExMzU0OS4xLjEuMTEiLCJzaWduYXR1cmUiOiLCjFvDmnXCkmlhwrrDj8ORYsKjwp7Cg19VwrLCsE9cdTAwMDTDscOlw4NbaERcdTAwMWPCp8KVQ29lKcO6ZVx1MDAwMMOoWVx1MDAwNMKNwoLDpcOrwqVcdTAwMWJcdTAwMDfClFxmf3Q0wrLCtm/CjzRoQMO+w7xpUytjwoXDjMK+asOZeMKBb3JcdTAwMTLCpS/CokbDsMOkVkVcZlx1MDAxNjNcImxhZmpcdTAwMGZcdTAwMGbCqHnDvlx1MDAxM8KmVMOjwrpcdTAwMDRcdTAwMTHDmsKpw45af0RcdTAwMDPDq8OeLcOjw6zDt8OqK2bDvMO4wr3CgMOuUMOzwphfw5Q9w5nChT3DnMKCXHUwMDBlw7VccsOswoIkXHUwMDBmfUhcdTAwMTA7woJHR8Oyw5pcdTAwMGXCmlx1MDAxY0ttw55cdTAwMDfCqcOtc1xubSMsXCIvaDHCk27DgCvDlMORwpbCoMOfw5FYXlxuXHLCusKvXHUwMDExKMOVXHUwMDAywrRzw5rCvlPDgi/Cu39cbsKMwrHCslx1MDAwZcKPdMOaw4ZcdTAwMDDDl1x1MDAwM8KlXHUwMDBmXHUwMDE0wqnCt8O9wobCpMK0w7PDsltcdTAwMWRcdTAwMTbCgG7DksOIwrlQJVx1MDAwNko9b01cdTAwMWNcdTAwMTN3M8OXfmE8TntccsOLw4p1w71cdTAwMWMoXGIsw4fCiCIsInNpZ2luZm8iOnsiYWxnb3JpdGhtT2lkIjoiMS4yLjg0MC4xMTM1NDkuMS4xLjExIiwicGFyYW1ldGVycyI6e319LCJ2YWxpZGl0eSI6eyJub3RCZWZvcmUiOiIyMDE5LTA4LTEzVDE2OjE3OjMyLjAwMFoiLCJub3RBZnRlciI6IjIwMjAtMDgtMTNUMDA6MDA6MDAuMDAwWiJ9LCJpc3N1ZXIiOnsiYXR0cmlidXRlcyI6W3sidHlwZSI6IjIuNS40LjMiLCJ2YWx1ZSI6ImJqb3NidXJuLWRlc2sxLmFtci5jb3JwLmludGVsLmNvbSIsInZhbHVlVGFnQ2xhc3MiOjE5LCJuYW1lIjoiY29tbW9uTmFtZSIsInNob3J0TmFtZSI6IkNOIn1dLCJoYXNoIjoiY2Q0YjgxM2QzNDY0ZjA4YWFhYzI0NmZiMTA5ZmI2Y2E5YmY5MmQzZCJ9LCJzdWJqZWN0Ijp7ImF0dHJpYnV0ZXMiOlt7InR5cGUiOiIyLjUuNC4zIiwidmFsdWUiOiJiam9zYnVybi1kZXNrMS5hbXIuY29ycC5pbnRlbC5jb20iLCJ2YWx1ZVRhZ0NsYXNzIjoxOSwibmFtZSI6ImNvbW1vbk5hbWUiLCJzaG9ydE5hbWUiOiJDTiJ9XSwiaGFzaCI6ImNkNGI4MTNkMzQ2NGYwOGFhYWMyNDZmYjEwOWZiNmNhOWJmOTJkM2QifSwiZXh0ZW5zaW9ucyI6W3siaWQiOiIyLjUuMjkuMTUiLCJjcml0aWNhbCI6ZmFsc2UsInZhbHVlIjoiXHUwMDAzXHUwMDAyXHUwMDA0MCIsIm5hbWUiOiJrZXlVc2FnZSIsImRpZ2l0YWxTaWduYXR1cmUiOmZhbHNlLCJub25SZXB1ZGlhdGlvbiI6ZmFsc2UsImtleUVuY2lwaGVybWVudCI6dHJ1ZSwiZGF0YUVuY2lwaGVybWVudCI6dHJ1ZSwia2V5QWdyZWVtZW50IjpmYWxzZSwia2V5Q2VydFNpZ24iOmZhbHNlLCJjUkxTaWduIjpmYWxzZSwiZW5jaXBoZXJPbmx5IjpmYWxzZSwiZGVjaXBoZXJPbmx5IjpmYWxzZX0seyJpZCI6IjIuNS4yOS4zNyIsImNyaXRpY2FsIjpmYWxzZSwidmFsdWUiOiIwXG5cdTAwMDZcYitcdTAwMDZcdTAwMDFcdTAwMDVcdTAwMDVcdTAwMDdcdTAwMDNcdTAwMDEiLCJuYW1lIjoiZXh0S2V5VXNhZ2UiLCJzZXJ2ZXJBdXRoIjp0cnVlfSx7ImlkIjoiMi41LjI5LjE3IiwiY3JpdGljYWwiOmZhbHNlLCJ2YWx1ZSI6IjAjwoIhYmpvc2J1cm4tZGVzazEuYW1yLmNvcnAuaW50ZWwuY29tIiwibmFtZSI6InN1YmplY3RBbHROYW1lIiwiYWx0TmFtZXMiOlt7InR5cGUiOjIsInZhbHVlIjoiYmpvc2J1cm4tZGVzazEuYW1yLmNvcnAuaW50ZWwuY29tIn1dfV0sInB1YmxpY0tleSI6eyJuIjp7ImRhdGEiOlsyMjczODU0NSwxOTc1ODc5NzUsNDAzODk2MzIsMTI4NTc0NzE4LDI0MDUwNjYwOSw2MzgwODAwNCw2NzE4NzA1MiwzNTkxOTU3MiwxNjk3MzczNjYsMzM5MzY1NjUsMTg1NjM1NjIwLDE0NzQ5Mjk5MCwyMTI4NjY1NTUsODQzOTU3MDcsMTg1NDE2NDQ2LDkzNTg3NjcsMjAyNDQ1MDU0LDIzNjcwMzQ1MCw0ODk2NjM2OCwxMzgxNjEzMTgsMTE4MTQ4NDU2LDI0MzA2Njk3NiwxNzA4MTA4ODksNTkwNjE1MDgsMzg3MjExMTEsNTgyMjE5OSwxMzg3MDkwMzYsMTAyMTAyOTMxLDExNjIyNjYzOSwyNjU3MTMzMTYsNzE2MDc4NywxMzQzMDg0NjksMjI2NDI3OTcwLDE5ODQ2ODI3MSwyODczODUzOCwxMTgwOTU3NDYsMjAxMzM4NzUxLDgxOTcwNDU1LDY3Nzc4MDI4LDQ2ODMzMjM5LDIwMjAwMzE4LDE5MDY5MDYzNywxOTMwOTkxNDgsMTg3ODI3OSwyNTIxNDQ2MzcsMjUzMTE4ODU1LDc2OTg0NzE0LDgyNDQ3MjY0LDI0MDEyMjcwMSwyMTM3OTYyNzcsOTQxODQ1NDgsMTI3NjE3MzMyLDcwOTg1MzE1LDMwMzcwNzM1LDI2NjU1MDYyMCw4NTQyMTU0NywxNTkxODgzNjgsMjAyNDAwMzMyLDIxODkyNTgxMywxMjkyMTUxNTYsMjMyMzQ2OTQwLDExNzYxODI0OCwyNjg0MTYyOTgsNzgwNTkzOSwyMjc5ODM5ODksNTYwOTMxMTEsMjM2MjEyODgyLDIzMDYyNjAzMSwxMjA1OTM3NzEsODUzODE5MDksOTMxMjEyODIsMjYwMzEyODgxLDg2NTIxNzYwLDEyXSwidCI6NzQsInMiOjB9LCJlIjp7ImRhdGEiOls2NTUzN10sInQiOjEsInMiOjB9fSwibWQiOnsiYWxnb3JpdGhtIjoic2hhMjU2IiwiYmxvY2tMZW5ndGgiOjY0LCJkaWdlc3RMZW5ndGgiOjMyLCJtZXNzYWdlTGVuZ3RoIjo1NDQsImZ1bGxNZXNzYWdlTGVuZ3RoIjpbMCw1NDRdLCJtZXNzYWdlTGVuZ3RoU2l6ZSI6OCwibWVzc2FnZUxlbmd0aDY0IjpbMCw1NDRdfSwic2lnbmF0dXJlUGFyYW1ldGVycyI6e30sInRic0NlcnRpZmljYXRlIjp7InRhZ0NsYXNzIjowLCJ0eXBlIjoxNiwiY29uc3RydWN0ZWQiOnRydWUsImNvbXBvc2VkIjp0cnVlLCJ2YWx1ZSI6W3sidGFnQ2xhc3MiOjEyOCwidHlwZSI6MCwiY29uc3RydWN0ZWQiOnRydWUsImNvbXBvc2VkIjp0cnVlLCJ2YWx1ZSI6W3sidGFnQ2xhc3MiOjAsInR5cGUiOjIsImNvbnN0cnVjdGVkIjpmYWxzZSwiY29tcG9zZWQiOmZhbHNlLCJ2YWx1ZSI6Ilx1MDAwMiJ9XX0seyJ0YWdDbGFzcyI6MCwidHlwZSI6MiwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiMDJcdTAwMWJPwqnCqUDCr0fCpMO+w4jDg3t8w4IifSx7InRhZ0NsYXNzIjowLCJ0eXBlIjoxNiwiY29uc3RydWN0ZWQiOnRydWUsImNvbXBvc2VkIjp0cnVlLCJ2YWx1ZSI6W3sidGFnQ2xhc3MiOjAsInR5cGUiOjYsImNvbnN0cnVjdGVkIjpmYWxzZSwiY29tcG9zZWQiOmZhbHNlLCJ2YWx1ZSI6IirChkjChsO3XHJcdTAwMDFcdTAwMDFcdTAwMGIifSx7InRhZ0NsYXNzIjowLCJ0eXBlIjo1LCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjpmYWxzZSwidmFsdWUiOiIifV19LHsidGFnQ2xhc3MiOjAsInR5cGUiOjE2LCJjb25zdHJ1Y3RlZCI6dHJ1ZSwiY29tcG9zZWQiOnRydWUsInZhbHVlIjpbeyJ0YWdDbGFzcyI6MCwidHlwZSI6MTcsImNvbnN0cnVjdGVkIjp0cnVlLCJjb21wb3NlZCI6dHJ1ZSwidmFsdWUiOlt7InRhZ0NsYXNzIjowLCJ0eXBlIjoxNiwiY29uc3RydWN0ZWQiOnRydWUsImNvbXBvc2VkIjp0cnVlLCJ2YWx1ZSI6W3sidGFnQ2xhc3MiOjAsInR5cGUiOjYsImNvbnN0cnVjdGVkIjpmYWxzZSwiY29tcG9zZWQiOmZhbHNlLCJ2YWx1ZSI6IlVcdTAwMDRcdTAwMDMifSx7InRhZ0NsYXNzIjowLCJ0eXBlIjoxOSwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiYmpvc2J1cm4tZGVzazEuYW1yLmNvcnAuaW50ZWwuY29tIn1dfV19XX0seyJ0YWdDbGFzcyI6MCwidHlwZSI6MTYsImNvbnN0cnVjdGVkIjp0cnVlLCJjb21wb3NlZCI6dHJ1ZSwidmFsdWUiOlt7InRhZ0NsYXNzIjowLCJ0eXBlIjoyMywiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiMTkwODEzMTYxNzMyWiJ9LHsidGFnQ2xhc3MiOjAsInR5cGUiOjIzLCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjpmYWxzZSwidmFsdWUiOiIyMDA4MTMwMDAwMDBaIn1dfSx7InRhZ0NsYXNzIjowLCJ0eXBlIjoxNiwiY29uc3RydWN0ZWQiOnRydWUsImNvbXBvc2VkIjp0cnVlLCJ2YWx1ZSI6W3sidGFnQ2xhc3MiOjAsInR5cGUiOjE3LCJjb25zdHJ1Y3RlZCI6dHJ1ZSwiY29tcG9zZWQiOnRydWUsInZhbHVlIjpbeyJ0YWdDbGFzcyI6MCwidHlwZSI6MTYsImNvbnN0cnVjdGVkIjp0cnVlLCJjb21wb3NlZCI6dHJ1ZSwidmFsdWUiOlt7InRhZ0NsYXNzIjowLCJ0eXBlIjo2LCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjpmYWxzZSwidmFsdWUiOiJVXHUwMDA0XHUwMDAzIn0seyJ0YWdDbGFzcyI6MCwidHlwZSI6MTksImNvbnN0cnVjdGVkIjpmYWxzZSwiY29tcG9zZWQiOmZhbHNlLCJ2YWx1ZSI6ImJqb3NidXJuLWRlc2sxLmFtci5jb3JwLmludGVsLmNvbSJ9XX1dfV19LHsidGFnQ2xhc3MiOjAsInR5cGUiOjE2LCJjb25zdHJ1Y3RlZCI6dHJ1ZSwiY29tcG9zZWQiOnRydWUsInZhbHVlIjpbeyJ0YWdDbGFzcyI6MCwidHlwZSI6MTYsImNvbnN0cnVjdGVkIjp0cnVlLCJjb21wb3NlZCI6dHJ1ZSwidmFsdWUiOlt7InRhZ0NsYXNzIjowLCJ0eXBlIjo2LCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjpmYWxzZSwidmFsdWUiOiIqwoZIwobDt1xyXHUwMDAxXHUwMDAxXHUwMDAxIn0seyJ0YWdDbGFzcyI6MCwidHlwZSI6NSwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiIn1dfSx7InRhZ0NsYXNzIjowLCJ0eXBlIjozLCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjp0cnVlLCJ2YWx1ZSI6W3sidGFnQ2xhc3MiOjAsInR5cGUiOjE2LCJjb25zdHJ1Y3RlZCI6dHJ1ZSwiY29tcG9zZWQiOnRydWUsInZhbHVlIjpbeyJ0YWdDbGFzcyI6MCwidHlwZSI6MiwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiXHUwMDAww4UoN8Kgw7hAw7NcdTAwMTXCjMOrXHUwMDAyUW0xVzBcdTAwMWRrw5vDsS7Dvlx1MDAxNFLCkjV+wpt9wpbDgnVcdTAwMDdxwr8/w7/CtSpwK2TCjcOZVTx7OsKrTVxmworDtcOBXHUwMDA2JMOJfVx1MDAwNcKQUXbDnsK/w6M9XFxcdTAwMWPDtsK6w7Q7JmN5wrTCk0XCnSRkw4vDpFteT8O7TU7CoMK6XHUwMDA0wpbCscKKw7Fkwph/XHUwMDA3a8O9XHUwMDAxw4rCkHvCgnXCjMK1w5tUw5E0O34swqnDpXRcbjXDrE4sUXxcdTAwMDAvf3DCn8O4IcK2woPDqsK9RirDvX9cdTAwMDRCwoBcdTAwMTYnUG1Dw5PDvWdqRsOtek9hX3k4RMKILFx1MDAwNcKNb3JOw5ZXOFNQSi5eXHTDp8OOwoZcdTAwMDdcbsONaMKDw4LDimLDqyrDoMOhwrzDrcKsXHUwMDExXHUwMDEww75cYsOsw5rDu1xyOsO+UHxrwrzCsFx1MDAxNcO7wozCqVx1MDAwN8OrXHUwMDEwwpMkIF1LWlx1MDAxZMO8wpZcIkFtRFx1MDAwMTFsPMOaIE5Vw5bDsXrCnk/DomhMXHUwMDAwwrxvQHFaw7ZxIn0seyJ0YWdDbGFzcyI6MCwidHlwZSI6MiwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiXHUwMDAxXHUwMDAwXHUwMDAxIn1dfV0sImJpdFN0cmluZ0NvbnRlbnRzIjoiXHUwMDAwMMKCXHUwMDAxXG5cdTAwMDLCglx1MDAwMVx1MDAwMVx1MDAwMMOFKDfCoMO4QMOzXHUwMDE1wozDq1x1MDAwMlFtMVcwXHUwMDFka8Obw7Euw75cdTAwMTRSwpI1fsKbfcKWw4J1XHUwMDA3ccK/P8O/wrUqcCtkwo3DmVU8ezrCq01cZsKKw7XDgVx1MDAwNiTDiX1cdTAwMDXCkFF2w57Cv8OjPVxcXHUwMDFjw7bCusO0OyZjecK0wpNFwp0kZMOLw6RbXk/Du01OwqDCulx1MDAwNMKWwrHCisOxZMKYf1x1MDAwN2vDvVx1MDAwMcOKwpB7woJ1wozCtcObVMORNDt+LMKpw6V0XG41w6xOLFF8XHUwMDAwL39wwp/DuCHCtsKDw6rCvUYqw71/XHUwMDA0QsKAXHUwMDE2J1BtQ8OTw71nakbDrXpPYV95OETCiCxcdTAwMDXCjW9yTsOWVzhTUEouXlx0w6fDjsKGXHUwMDA3XG7DjWjCg8OCw4piw6sqw6DDocK8w63CrFx1MDAxMVx1MDAxMMO+XGLDrMOaw7tccjrDvlB8a8K8wrBcdTAwMTXDu8KMwqlcdTAwMDfDq1x1MDAxMMKTJCBdS1pcdTAwMWTDvMKWXCJBbURcdTAwMDExbDzDmiBOVcOWw7F6wp5Pw6JoTFx1MDAwMMK8b0BxWsO2cVx1MDAwMlx1MDAwM1x1MDAwMVx1MDAwMFx1MDAwMSIsIm9yaWdpbmFsIjp7InRhZ0NsYXNzIjowLCJ0eXBlIjozLCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjp0cnVlLCJ2YWx1ZSI6W3sidGFnQ2xhc3MiOjAsInR5cGUiOjE2LCJjb25zdHJ1Y3RlZCI6dHJ1ZSwiY29tcG9zZWQiOnRydWUsInZhbHVlIjpbeyJ0YWdDbGFzcyI6MCwidHlwZSI6MiwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiXHUwMDAww4UoN8Kgw7hAw7NcdTAwMTXCjMOrXHUwMDAyUW0xVzBcdTAwMWRrw5vDsS7Dvlx1MDAxNFLCkjV+wpt9wpbDgnVcdTAwMDdxwr8/w7/CtSpwK2TCjcOZVTx7OsKrTVxmworDtcOBXHUwMDA2JMOJfVx1MDAwNcKQUXbDnsK/w6M9XFxcdTAwMWPDtsK6w7Q7JmN5wrTCk0XCnSRkw4vDpFteT8O7TU7CoMK6XHUwMDA0wpbCscKKw7Fkwph/XHUwMDA3a8O9XHUwMDAxw4rCkHvCgnXCjMK1w5tUw5E0O34swqnDpXRcbjXDrE4sUXxcdTAwMDAvf3DCn8O4IcK2woPDqsK9RirDvX9cdTAwMDRCwoBcdTAwMTYnUG1Dw5PDvWdqRsOtek9hX3k4RMKILFx1MDAwNcKNb3JOw5ZXOFNQSi5eXHTDp8OOwoZcdTAwMDdcbsONaMKDw4LDimLDqyrDoMOhwrzDrcKsXHUwMDExXHUwMDEww75cYsOsw5rDu1xyOsO+UHxrwrzCsFx1MDAxNcO7wozCqVx1MDAwN8OrXHUwMDEwwpMkIF1LWlx1MDAxZMO8wpZcIkFtRFx1MDAwMTFsPMOaIE5Vw5bDsXrCnk/DomhMXHUwMDAwwrxvQHFaw7ZxIn0seyJ0YWdDbGFzcyI6MCwidHlwZSI6MiwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiXHUwMDAxXHUwMDAwXHUwMDAxIn1dfV19fV19LHsidGFnQ2xhc3MiOjEyOCwidHlwZSI6MywiY29uc3RydWN0ZWQiOnRydWUsImNvbXBvc2VkIjp0cnVlLCJ2YWx1ZSI6W3sidGFnQ2xhc3MiOjAsInR5cGUiOjE2LCJjb25zdHJ1Y3RlZCI6dHJ1ZSwiY29tcG9zZWQiOnRydWUsInZhbHVlIjpbeyJ0YWdDbGFzcyI6MCwidHlwZSI6MTYsImNvbnN0cnVjdGVkIjp0cnVlLCJjb21wb3NlZCI6dHJ1ZSwidmFsdWUiOlt7InRhZ0NsYXNzIjowLCJ0eXBlIjo2LCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjpmYWxzZSwidmFsdWUiOiJVXHUwMDFkXHUwMDBmIn0seyJ0YWdDbGFzcyI6MCwidHlwZSI6NCwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiXHUwMDAzXHUwMDAyXHUwMDA0MCJ9XX0seyJ0YWdDbGFzcyI6MCwidHlwZSI6MTYsImNvbnN0cnVjdGVkIjp0cnVlLCJjb21wb3NlZCI6dHJ1ZSwidmFsdWUiOlt7InRhZ0NsYXNzIjowLCJ0eXBlIjo2LCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjpmYWxzZSwidmFsdWUiOiJVXHUwMDFkJSJ9LHsidGFnQ2xhc3MiOjAsInR5cGUiOjQsImNvbnN0cnVjdGVkIjpmYWxzZSwiY29tcG9zZWQiOmZhbHNlLCJ2YWx1ZSI6IjBcblx1MDAwNlxiK1x1MDAwNlx1MDAwMVx1MDAwNVx1MDAwNVx1MDAwN1x1MDAwM1x1MDAwMSJ9XX0seyJ0YWdDbGFzcyI6MCwidHlwZSI6MTYsImNvbnN0cnVjdGVkIjp0cnVlLCJjb21wb3NlZCI6dHJ1ZSwidmFsdWUiOlt7InRhZ0NsYXNzIjowLCJ0eXBlIjo2LCJjb25zdHJ1Y3RlZCI6ZmFsc2UsImNvbXBvc2VkIjpmYWxzZSwidmFsdWUiOiJVXHUwMDFkXHUwMDExIn0seyJ0YWdDbGFzcyI6MCwidHlwZSI6NCwiY29uc3RydWN0ZWQiOmZhbHNlLCJjb21wb3NlZCI6ZmFsc2UsInZhbHVlIjoiMCPCgiFiam9zYnVybi1kZXNrMS5hbXIuY29ycC5pbnRlbC5jb20ifV19XX1dfV19fV0sImtleXMiOlt7Im4iOnsiZGF0YSI6WzIyNzM4NTQ1LDE5NzU4Nzk3NSw0MDM4OTYzMiwxMjg1NzQ3MTgsMjQwNTA2NjA5LDYzODA4MDA0LDY3MTg3MDUyLDM1OTE5NTcyLDE2OTczNzM2NiwzMzkzNjU2NSwxODU2MzU2MjAsMTQ3NDkyOTkwLDIxMjg2NjU1NSw4NDM5NTcwNywxODU0MTY0NDYsOTM1ODc2NywyMDI0NDUwNTQsMjM2NzAzNDUwLDQ4OTY2MzY4LDEzODE2MTMxOCwxMTgxNDg0NTYsMjQzMDY2OTc2LDE3MDgxMDg4OSw1OTA2MTUwOCwzODcyMTExMSw1ODIyMTk5LDEzODcwOTAzNiwxMDIxMDI5MzEsMTE2MjI2NjM5LDI2NTcxMzMxNiw3MTYwNzg3LDEzNDMwODQ2OSwyMjY0Mjc5NzAsMTk4NDY4MjcxLDI4NzM4NTM4LDExODA5NTc0NiwyMDEzMzg3NTEsODE5NzA0NTUsNjc3NzgwMjgsNDY4MzMyMzksMjAyMDAzMTgsMTkwNjkwNjM3LDE5MzA5OTE0OCwxODc4Mjc5LDI1MjE0NDYzNywyNTMxMTg4NTUsNzY5ODQ3MTQsODI0NDcyNjQsMjQwMTIyNzAxLDIxMzc5NjI3Nyw5NDE4NDU0OCwxMjc2MTczMzIsNzA5ODUzMTUsMzAzNzA3MzUsMjY2NTUwNjIwLDg1NDIxNTQ3LDE1OTE4ODM2OCwyMDI0MDAzMzIsMjE4OTI1ODEzLDEyOTIxNTE1NiwyMzIzNDY5NDAsMTE3NjE4MjQ4LDI2ODQxNjI5OCw3ODA1OTM5LDIyNzk4Mzk4OSw1NjA5MzExMSwyMzYyMTI4ODIsMjMwNjI2MDMxLDEyMDU5Mzc3MSw4NTM4MTkwOSw5MzEyMTI4MiwyNjAzMTI4ODEsODY1MjE3NjAsMTJdLCJ0Ijo3NCwicyI6MH0sImUiOnsiZGF0YSI6WzY1NTM3XSwidCI6MSwicyI6MH0sImQiOnsiZGF0YSI6WzEwMzc1ODYyOSwzNTE4MDMxLDIwNzcwNzY3NCwyMDc4Nzg2MjUsMzIzMzAxODAsMTkwNTg0NDQsNTg4ODI3NjYsMTg3NjQ1NDEsODIzMzkzNzYsMTA3MjM0NzY1LDU4OTA3MzE2LDIxNTIwMjE4LDg3NTY1OTM1LDI1NTQ3OTU2NCw0NTg4MDIyNywyMTg3MTAyNiwyNDM4NDk3MzcsMjIxMzA5MzcxLDEyMjczNzYyNSw5NzM2NjAzMiwxNzQwMDA0MDYsMTk3ODg0NTY2LDU1Mjg0NTY0LDM4Njk1NjU4LDEyNjEyODAzMSw4OTY1OTI3NSwxMTQyNzExMDYsMTg5NDgwMTQ2LDM2Njk1NDYxLDExNzQwMjEyMSw4MjE0NzExMywxNDM1MDc5MTUsMTUwMjY4MjkyLDExMTM3MTkzMCwxMTkzOTIwNDcsNDM0NDY3MjgsMjYxNDAzMDg0LDIwMTUxOTEwNSwxNTkwNjM5NDEsOTE0MjQwOTQsMTIxMTUyMjAxLDIxNDMwNTkwMSwyMDU5MjY4OTYsNTg1Nzg0MzksOTA3MjcxNTIsMjEyNjQ5ODgsMTAxNjc2NTY3LDE4MzgzMDEyOCwxODIzNzc3MTMsMTM3NzIzMzA3LDIxNzEwODI2Myw5MzM5ODU3MSwxODIyNTA0NiwyNjQxMjk2MjYsMjYzODg5OTI4LDIxODg5NTI0OCwxNTUzOTM5MDQsMjE0NTc2MDQ4LDE0ODgzNDQwNiwxOTc1NTk2NTEsNjA3Mjc2NTAsMTk2NzM2MjE3LDI1ODIxODE1NywyNTM0NTIzMzcsMjY0Nzk1OTQ0LDE5OTMyOTgxNyw0OTIzODYyOCwyMzMyNzkxNjEsNjE2ODg5OTIsMzU5Mjk2MTYsMjA2ODU4MTQzLDE1MzkwNDI0Myw4MjA4ODc0NCwxXSwidCI6NzQsInMiOjB9LCJwIjp7ImRhdGEiOlsyMjU4Njc2ODcsMTM3Mjc3OTcwLDE4Njc1NDE4MywxNzE0MzgwOTgsMTQ3NzkxNDc3LDI2NDI0ODAxLDIyNTA1OTM1NCwyNTE0MTgzMDksMTQwMTMyNDk0LDI3MjI0MzUyLDgyMzc5MDQ2LDI2MjgzMDE4MSwyMjgyODMzNTAsMjE4MDAxNzkxLDE5ODQyNTk1NCwyMTQyMTIxNDgsMjA0NDExNjg4LDExODEyMzkzLDc1OTc3OTcyLDU1MTU2NDksMTM5Mjk0OTg3LDI2OTIyMjUsNDIxMzYyOTksNzYzMTYwNjksMjUxMTc1MjgzLDIzNTQzNDIwOCwxNjg5ODYwOTUsNTA3NDk5MTUsNTk1MDk0NzMsMTU5MTk2NzQ3LDE0NTQxODI2LDc4NjgxNjkwLDMzOTAyNTE2LDE5MzczOTAxMiwxODUzMjU2MDksMTYxNDgwMjgsNTUyMTVdLCJ0IjozNywicyI6MH0sInEiOnsiZGF0YSI6WzEzNTQ1NTc4MywxNDE2NzUyMjYsNzI0NTU1NjMsMTkyMzE2NTM1LDIyNzU2MTY4Myw5MjQ0Mzg1LDE1MDQxNzAzOSwxNzkwNDcwMTAsMjQwNzcwNDgzLDIzNzI3ODI4MiwyNTUyMDAzNzYsOTg5MjUwMiwyMzI3MzcwNjQsMTgxMTM4MTY5LDQzMjEzMTg4LDEyMDE0MTQ2NSw2MTcxMDUyMSwxMDM2MjQyMTYsMTMxNzgwOTAxLDE2NzY4ODUwNywxNDY1NTQ0NjUsMjYwMzYxMzMsOTU5MjA2NjcsOTkwMzU1MzEsNTE1MTkxMDEsOTIwOTI4ODUsMjQzMjM1NDc4LDE0OTk3MjMyNywxNTU1MzU5NywxMzYzOTE3NzAsMjAxNzcyMzY0LDE5NTE3Mjc1NywxOTQyMjAxNDcsMTU0NzA0MTgyLDE4NTkwODk3OSwxNjQ1MTQxMTYsNTk5MDZdLCJ0IjozNywicyI6MH0sImRQIjp7ImRhdGEiOlsyMTI2NTAyNDksNTkzMjcxOSwzMTMwNjcxMSwxOTQ1MjkxMjMsNDkwMDExMiwyNTUwOTE4MCwxODMwMDM0NzMsMzA5MzAzMTgsMTA4Njg4MjYyLDU0NjU5Njc4LDIwODQ5NTg3MCw1MjgxMDQ3MSwxOTIwODQ3MjAsMjMwMDg2MTUyLDE5Mzc4OTg4NCw3OTI2OTMyOCwyNjE1MTIyMjcsMTI1NTU2NzgzLDE1NTA4NDYyMywxOTQ5Mjg3MjcsMjI3NzI0NTY4LDE4NjA0ODQ2OSwxNTIwMzkwNjYsMzkwMTMwOTksMjMzNzU2MjM4LDE4NTY5MjU1OSwyMzgxNjM3MzIsNDA2MTM5NDIsMjM1MDk1Mjg0LDIwNjA0MzU3OSw5NjE5NTUxNSwxNTI0MjMxMDUsOTUwOTE5NSwxOTg2MjMyNzQsMTgxMjc0Mjc1LDE5OTkwMzgzMiwyOTk2Ml0sInQiOjM3LCJzIjowfSwiZFEiOnsiZGF0YSI6WzIxNDg4NDg0NywyMDQ0ODU5MzIsMjU0NzMzMzQ0LDIwNzg2MTE2MSw4NDAxNjExNSwyMDUzMzc4NjYsMTkxNDEyMDk3LDIyMjA3NDI2MCwxNDQ2OTI2NTEsMjI0OTU3MzM5LDc1MDIxNjYyLDIyNzE2MjExNyw3NDUyNjMyNywxNTIwNTIwOSwxNjIwNjYwNzAsMzMxODUxNjIsMjQxNzI4NjgyLDE1OTI5MzczNiwxNjc1OTY0ODEsMzU1NTExNSwyNTU1MTk0NDEsNjU3MzEyODAsMTEyNTM4MzM4LDYwMzQ0MTgzLDI0NDk5MzQyMiwyMDg4NTY0OCwxNTE0NzQ3OTEsMjU3ODQ0NjQxLDE3MzkxOTMxOSwyMjE1MzE4NTksMTIyNzYxODg5LDE0MDkwMzE3NiwxMTE4NTEyNTIsMjQzNTE4MDk0LDEzODU4ODQ4OCwyNDA2MzEyMjAsNDc5XSwidCI6MzcsInMiOjB9LCJxSW52Ijp7ImRhdGEiOlsxMTQ2MjYxNzAsMjI1Njg5OTcwLDYzNTE2MDI0LDE0ODI3NjUxNywyMTg2ODM0NzQsMTkyNDQ3Mjk2LDEzMDU3MjIxOSwyMjMxNDU5MjEsMjM3MDg3NTI2LDE5NzAxNDQyNCwyMzI4OTUwMjEsMTkzMDMxOTg1LDYyNTI4MzE4LDEyNTk3MDM2LDg1NzA4MzU5LDk1ODA0NjgxLDU5MjA4MDAwLDE5MTA1MzQ1LDExMjkxOTU2NSwxMzA2NDIwMjYsMTg0Mjg3MDg0LDIwODk2Njg0Niw5OTIwMDMzNywxMzgzNDEwMzYsMTYwNjk1MTg4LDUxOTg1OTU3LDYyNzQ5MTY0LDIxMDYyMDMwMywxNjE2MDUwMDcsODQ5MzI1MjAsMjE5ODgyMzgzLDIwMTM0ODA4NywxOTYyMTM4MzgsMzk5Njk1MTMsMjY0MDAzNTE0LDY4OTU3NjI4LDE0MjE4XSwidCI6MzcsInMiOjB9fV19"

    let buf = Buffer.from(input, "base64").toString();

    var obj = JSON.parse(buf);

    let nodeForge = new NodeForge();
    let certManager = new CertManager(nodeForge);

    let certChainPfx = certManager.dumpPfx(obj);

    let dumpPfxJson: string = JSON.stringify(certChainPfx)
    let dumpPfxJson64 = Buffer.from(dumpPfxJson).toString("base64");

    let expectedDumpPfx: string = "eyJwcm92aXNpb25pbmdDZXJ0aWZpY2F0ZU9iaiI6eyJjZXJ0Q2hhaW4iOlsiXHJcbk1JSURORENDQWh5Z0F3SUJBZ0lRTURJYlQ2bXBRSzlIcFA3SXczdDh3akFOQmdrcWhraUc5dzBCQVFzRkFEQXNcclxuTVNvd0tBWURWUVFERXlGaWFtOXpZblZ5Ymkxa1pYTnJNUzVoYlhJdVkyOXljQzVwYm5SbGJDNWpiMjB3SGhjTlxyXG5NVGt3T0RFek1UWXhOek15V2hjTk1qQXdPREV6TURBd01EQXdXakFzTVNvd0tBWURWUVFERXlGaWFtOXpZblZ5XHJcbmJpMWtaWE5yTVM1aGJYSXVZMjl5Y0M1cGJuUmxiQzVqYjIwd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJcclxuRHdBd2dnRUtBb0lCQVFERktEZWcrRUR6Rll6ckFsRnRNVmN3SFd2YjhTNytGRktTTlg2YmZaYkNkUWR4dnovL1xyXG50U3B3SzJTTjJWVThlenFyVFF5SzljRUdKTWw5QlpCUmR0Ni80ejFjSFBhNjlEc21ZM20wazBXZEpHVEw1RnRlXHJcblQvdE5UcUM2QkpheGl2RmttSDhIYS8wQnlwQjdnbldNdGR0VTBUUTdmaXlwNVhRS05leE9MRkY4QUM5L2NKLzRcclxuSWJhRDZyMUdLdjEvQkVLQUZpZFFiVVBUL1dkcVJ1MTZUMkZmZVRoRWlDd0ZqVzl5VHRaWE9GTlFTaTVlQ2VmT1xyXG5oZ2NLeldpRHdzcGk2eXJnNGJ6dHJCRVEvZ2pzMnZzTk92NVFmR3U4c0JYN2pLa0g2eENUSkNCZFMxb2QvSllpXHJcblFXMUVBVEZzUE5vZ1RsWFc4WHFlVCtKb1RBQzhiMEJ4V3ZaeEFnTUJBQUdqVWpCUU1Bc0dBMVVkRHdRRUF3SUVcclxuTURBVEJnTlZIU1VFRERBS0JnZ3JCZ0VGQlFjREFUQXNCZ05WSFJFRUpUQWpnaUZpYW05elluVnliaTFrWlhOclxyXG5NUzVoYlhJdVkyOXljQzVwYm5SbGJDNWpiMjB3RFFZSktvWklodmNOQVFFTEJRQURnZ0VCQUl4YjJuV1NhV0c2XHJcbno5RmlvNTZEWDFXeXNFOEU4ZVhEVzJoRUhLZVZRMjlsS2ZwbEFPaFpCSTJDNWV1bEd3ZVVESDkwTkxLMmI0ODBcclxuYUVEKy9HbFRLMk9Gekw1cTJYaUJiM0lTcFMraVJ2RGtWa1VNRmpNaWJHRm1hZzhQcUhuK0U2WlU0N29FRWRxcFxyXG56bHAvUkFQcjNpM2o3UGZxSzJiOCtMMkE3bER6bUYvVVBkbUZQZHlDRHZVTjdJSWtEMzFJRUR1Q1IwZnkyZzZhXHJcbkhFdHQzZ2VwN1hNS2JTTXNJaTlvTVpOdXdDdlUwWmFnMzlGWVhnb051cThSS05VQ3RIUGF2bFBDTDd0L0NveXhcclxuc2c2UGROckdBTmNEcFE4VXFiZjlocVMwOC9KYkhSYUFidExJdVZBbEJrbzliMDBjRTNjejEzNWhQRTU3RGN2S1xyXG5kZjBjS0Fnc3g0Zz1cclxuXHJcbiIsbnVsbF0sInByaXZhdGVLZXkiOnsibiI6eyJkYXRhIjpbMjI3Mzg1NDUsMTk3NTg3OTc1LDQwMzg5NjMyLDEyODU3NDcxOCwyNDA1MDY2MDksNjM4MDgwMDQsNjcxODcwNTIsMzU5MTk1NzIsMTY5NzM3MzY2LDMzOTM2NTY1LDE4NTYzNTYyMCwxNDc0OTI5OTAsMjEyODY2NTU1LDg0Mzk1NzA3LDE4NTQxNjQ0Niw5MzU4NzY3LDIwMjQ0NTA1NCwyMzY3MDM0NTAsNDg5NjYzNjgsMTM4MTYxMzE4LDExODE0ODQ1NiwyNDMwNjY5NzYsMTcwODEwODg5LDU5MDYxNTA4LDM4NzIxMTExLDU4MjIxOTksMTM4NzA5MDM2LDEwMjEwMjkzMSwxMTYyMjY2MzksMjY1NzEzMzE2LDcxNjA3ODcsMTM0MzA4NDY5LDIyNjQyNzk3MCwxOTg0NjgyNzEsMjg3Mzg1MzgsMTE4MDk1NzQ2LDIwMTMzODc1MSw4MTk3MDQ1NSw2Nzc3ODAyOCw0NjgzMzIzOSwyMDIwMDMxOCwxOTA2OTA2MzcsMTkzMDk5MTQ4LDE4NzgyNzksMjUyMTQ0NjM3LDI1MzExODg1NSw3Njk4NDcxNCw4MjQ0NzI2NCwyNDAxMjI3MDEsMjEzNzk2Mjc3LDk0MTg0NTQ4LDEyNzYxNzMzMiw3MDk4NTMxNSwzMDM3MDczNSwyNjY1NTA2MjAsODU0MjE1NDcsMTU5MTg4MzY4LDIwMjQwMDMzMiwyMTg5MjU4MTMsMTI5MjE1MTU2LDIzMjM0Njk0MCwxMTc2MTgyNDgsMjY4NDE2Mjk4LDc4MDU5MzksMjI3OTgzOTg5LDU2MDkzMTExLDIzNjIxMjg4MiwyMzA2MjYwMzEsMTIwNTkzNzcxLDg1MzgxOTA5LDkzMTIxMjgyLDI2MDMxMjg4MSw4NjUyMTc2MCwxMl0sInQiOjc0LCJzIjowfSwiZSI6eyJkYXRhIjpbNjU1MzddLCJ0IjoxLCJzIjowfSwiZCI6eyJkYXRhIjpbMTAzNzU4NjI5LDM1MTgwMzEsMjA3NzA3Njc0LDIwNzg3ODYyNSwzMjMzMDE4MCwxOTA1ODQ0NCw1ODg4Mjc2NiwxODc2NDU0MSw4MjMzOTM3NiwxMDcyMzQ3NjUsNTg5MDczMTYsMjE1MjAyMTgsODc1NjU5MzUsMjU1NDc5NTY0LDQ1ODgwMjI3LDIxODcxMDI2LDI0Mzg0OTczNywyMjEzMDkzNzEsMTIyNzM3NjI1LDk3MzY2MDMyLDE3NDAwMDQwNiwxOTc4ODQ1NjYsNTUyODQ1NjQsMzg2OTU2NTgsMTI2MTI4MDMxLDg5NjU5Mjc1LDExNDI3MTEwNiwxODk0ODAxNDYsMzY2OTU0NjEsMTE3NDAyMTIxLDgyMTQ3MTEzLDE0MzUwNzkxNSwxNTAyNjgyOTIsMTExMzcxOTMwLDExOTM5MjA0Nyw0MzQ0NjcyOCwyNjE0MDMwODQsMjAxNTE5MTA1LDE1OTA2Mzk0MSw5MTQyNDA5NCwxMjExNTIyMDEsMjE0MzA1OTAxLDIwNTkyNjg5Niw1ODU3ODQzOSw5MDcyNzE1MiwyMTI2NDk4OCwxMDE2NzY1NjcsMTgzODMwMTI4LDE4MjM3NzcxMywxMzc3MjMzMDcsMjE3MTA4MjYzLDkzMzk4NTcxLDE4MjI1MDQ2LDI2NDEyOTYyNiwyNjM4ODk5MjgsMjE4ODk1MjQ4LDE1NTM5MzkwNCwyMTQ1NzYwNDgsMTQ4ODM0NDA2LDE5NzU1OTY1MSw2MDcyNzY1MCwxOTY3MzYyMTcsMjU4MjE4MTU3LDI1MzQ1MjMzNywyNjQ3OTU5NDQsMTk5MzI5ODE3LDQ5MjM4NjI4LDIzMzI3OTE2MSw2MTY4ODk5MiwzNTkyOTYxNiwyMDY4NTgxNDMsMTUzOTA0MjQzLDgyMDg4NzQ0LDFdLCJ0Ijo3NCwicyI6MH0sInAiOnsiZGF0YSI6WzIyNTg2NzY4NywxMzcyNzc5NzAsMTg2NzU0MTgzLDE3MTQzODA5OCwxNDc3OTE0NzcsMjY0MjQ4MDEsMjI1MDU5MzU0LDI1MTQxODMwOSwxNDAxMzI0OTQsMjcyMjQzNTIsODIzNzkwNDYsMjYyODMwMTgxLDIyODI4MzM1MCwyMTgwMDE3OTEsMTk4NDI1OTU0LDIxNDIxMjE0OCwyMDQ0MTE2ODgsMTE4MTIzOTMsNzU5Nzc5NzIsNTUxNTY0OSwxMzkyOTQ5ODcsMjY5MjIyNSw0MjEzNjI5OSw3NjMxNjA2OSwyNTExNzUyODMsMjM1NDM0MjA4LDE2ODk4NjA5NSw1MDc0OTkxNSw1OTUwOTQ3MywxNTkxOTY3NDcsMTQ1NDE4MjYsNzg2ODE2OTAsMzM5MDI1MTYsMTkzNzM5MDEyLDE4NTMyNTYwOSwxNjE0ODAyOCw1NTIxNV0sInQiOjM3LCJzIjowfSwicSI6eyJkYXRhIjpbMTM1NDU1NzgzLDE0MTY3NTIyNiw3MjQ1NTU2MywxOTIzMTY1MzUsMjI3NTYxNjgzLDkyNDQzODUsMTUwNDE3MDM5LDE3OTA0NzAxMCwyNDA3NzA0ODMsMjM3Mjc4MjgyLDI1NTIwMDM3Niw5ODkyNTAyLDIzMjczNzA2NCwxODExMzgxNjksNDMyMTMxODgsMTIwMTQxNDY1LDYxNzEwNTIxLDEwMzYyNDIxNiwxMzE3ODA5MDEsMTY3Njg4NTA3LDE0NjU1NDQ2NSwyNjAzNjEzMyw5NTkyMDY2Nyw5OTAzNTUzMSw1MTUxOTEwMSw5MjA5Mjg4NSwyNDMyMzU0NzgsMTQ5OTcyMzI3LDE1NTUzNTk3LDEzNjM5MTc3MCwyMDE3NzIzNjQsMTk1MTcyNzU3LDE5NDIyMDE0NywxNTQ3MDQxODIsMTg1OTA4OTc5LDE2NDUxNDExNiw1OTkwNl0sInQiOjM3LCJzIjowfSwiZFAiOnsiZGF0YSI6WzIxMjY1MDI0OSw1OTMyNzE5LDMxMzA2NzExLDE5NDUyOTEyMyw0OTAwMTEyLDI1NTA5MTgwLDE4MzAwMzQ3MywzMDkzMDMxOCwxMDg2ODgyNjIsNTQ2NTk2NzgsMjA4NDk1ODcwLDUyODEwNDcxLDE5MjA4NDcyMCwyMzAwODYxNTIsMTkzNzg5ODg0LDc5MjY5MzI4LDI2MTUxMjIyNywxMjU1NTY3ODMsMTU1MDg0NjIzLDE5NDkyODcyNywyMjc3MjQ1NjgsMTg2MDQ4NDY5LDE1MjAzOTA2NiwzOTAxMzA5OSwyMzM3NTYyMzgsMTg1NjkyNTU5LDIzODE2MzczMiw0MDYxMzk0MiwyMzUwOTUyODQsMjA2MDQzNTc5LDk2MTk1NTE1LDE1MjQyMzEwNSw5NTA5MTk1LDE5ODYyMzI3NCwxODEyNzQyNzUsMTk5OTAzODMyLDI5OTYyXSwidCI6MzcsInMiOjB9LCJkUSI6eyJkYXRhIjpbMjE0ODg0ODQ3LDIwNDQ4NTkzMiwyNTQ3MzMzNDQsMjA3ODYxMTYxLDg0MDE2MTE1LDIwNTMzNzg2NiwxOTE0MTIwOTcsMjIyMDc0MjYwLDE0NDY5MjY1MSwyMjQ5NTczMzksNzUwMjE2NjIsMjI3MTYyMTE3LDc0NTI2MzI3LDE1MjA1MjA5LDE2MjA2NjA3MCwzMzE4NTE2MiwyNDE3Mjg2ODIsMTU5MjkzNzM2LDE2NzU5NjQ4MSwzNTU1MTE1LDI1NTUxOTQ0MSw2NTczMTI4MCwxMTI1MzgzMzgsNjAzNDQxODMsMjQ0OTkzNDIyLDIwODg1NjQ4LDE1MTQ3NDc5MSwyNTc4NDQ2NDEsMTczOTE5MzE5LDIyMTUzMTg1OSwxMjI3NjE4ODksMTQwOTAzMTc2LDExMTg1MTI1MiwyNDM1MTgwOTQsMTM4NTg4NDg4LDI0MDYzMTIyMCw0NzldLCJ0IjozNywicyI6MH0sInFJbnYiOnsiZGF0YSI6WzExNDYyNjE3MCwyMjU2ODk5NzAsNjM1MTYwMjQsMTQ4Mjc2NTE3LDIxODY4MzQ3NCwxOTI0NDcyOTYsMTMwNTcyMjE5LDIyMzE0NTkyMSwyMzcwODc1MjYsMTk3MDE0NDI0LDIzMjg5NTAyMSwxOTMwMzE5ODUsNjI1MjgzMTgsMTI1OTcwMzYsODU3MDgzNTksOTU4MDQ2ODEsNTkyMDgwMDAsMTkxMDUzNDUsMTEyOTE5NTY1LDEzMDY0MjAyNiwxODQyODcwODQsMjA4OTY2ODQ2LDk5MjAwMzM3LDEzODM0MTAzNiwxNjA2OTUxODgsNTE5ODU5NTcsNjI3NDkxNjQsMjEwNjIwMzAzLDE2MTYwNTAwNyw4NDkzMjUyMCwyMTk4ODIzODMsMjAxMzQ4MDg3LDE5NjIxMzgzOCwzOTk2OTUxMywyNjQwMDM1MTQsNjg5NTc2MjgsMTQyMThdLCJ0IjozNywicyI6MH19fX0=";


    expect(dumpPfxJson64).toEqual(expectedDumpPfx);
});
